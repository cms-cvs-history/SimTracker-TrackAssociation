process MCCand = {

  include "FWCore/MessageLogger/data/MessageLogger.cfi"
  include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"
#  include "PhysicsTools/HepMCCandAlgos/data/genParticleCandidates.cfi"
#  replace genParticleCandidates.saveBarCodes = true

  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
  include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"
  include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"
  include "TrackingTools/TransientTrack/data/TransientTrackBuilder.cfi"
  include "SimGeneral/TrackingAnalysis/data/trackingParticles.cfi"
  include "SimTracker/TrackAssociation/data/TrackAssociatorByChi2.cfi"
  include "SimTracker/TrackAssociation/data/TrackAssociatorByHits.cfi"

  untracked PSet maxEvents = {untracked int32 input = 10}

  source = PoolSource {
    untracked vstring fileNames = {
      '/store/mc/2007/12/7/RelVal-RelValBJets_Pt_50_120-1197045102/0002/0A21A5F4-02A5-DC11-89F5-000423DD2F34.root'
    }
  }

  module mcTrackMatch = MCTrackMatcher {
    InputTag tracks = ctfWithMaterialTracks
    InputTag genParticles = genParticles
    string associator = "TrackAssociatorByHits"
  }

  module out = PoolOutputModule {
    untracked string fileName = "out.root"
    untracked vstring outputCommands = {
      "drop *",
      "keep recoTracks_ctfWithMaterialTracks_*_*",
      "keep *_genParticles_*_*",
      "keep *_mcTrackMatch_*_*"
    }
  }

  path p = { trackingParticles, mcTrackMatch }
  endpath ep = { out }
}
