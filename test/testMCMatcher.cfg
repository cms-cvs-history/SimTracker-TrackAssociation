process MCCand = {

  include "FWCore/MessageLogger/data/MessageLogger.cfi"
  include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"
  include "PhysicsTools/HepMCCandAlgos/data/genParticleCandidates.cfi"
  replace genParticleCandidates.saveBarCodes = true

  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
  include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"
  include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"
  include "TrackingTools/TransientTrack/data/TransientTrackBuilder.cfi"
  include "SimGeneral/TrackingAnalysis/data/trackingParticles.cfi"
  include "SimTracker/TrackAssociation/data/TrackAssociatorByChi2.cfi"
  include "SimTracker/TrackAssociation/data/TrackAssociatorByHits.cfi"

  untracked PSet maxEvents = {untracked int32 input = 10}

  source = PoolSource {
    untracked vstring fileNames = {
      '/store/mc/2007/10/20/RelVal-RelValZMM-1192895175/0000/20279FC3-C480-DC11-B65F-000423D6B328.root',
#     '/store/mc/2007/10/20/RelVal-RelValSingleMuPlusPt100-1192895175/0000/34744FE2-AE7F-DC11-A6FC-0019DB29C620.root' 
     'file:/tmp/llista/34744FE2-AE7F-DC11-A6FC-0019DB29C620.root' 
    }
  }

  module mcTrackMatch = MCTrackMatcher {
    InputTag tracks = ctfWithMaterialTracks
    InputTag genParticles = genParticleCandidates
    string associator = "TrackAssociatorByHits"
  }

  module out = PoolOutputModule {
    untracked string fileName = "out.root"
    untracked vstring outputCommands = {
      "drop *",
      "keep recoTracks_ctfWithMaterialTracks_*_*",
      "keep recoCandidatesOwned_genParticleCandidates_*_*",
      "keep *_mcTrackMatch_*_*"
    }
  }

  path p = { genParticleCandidates, trackingParticles, mcTrackMatch }
  endpath ep = { out }
}
